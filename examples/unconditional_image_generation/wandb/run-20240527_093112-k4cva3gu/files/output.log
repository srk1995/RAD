05/27/2024 09:31:18 - INFO - __main__ - ***** Running training *****
05/27/2024 09:31:19 - INFO - __main__ -   Num examples = 28000
05/27/2024 09:31:19 - INFO - __main__ -   Num Epochs = 2000
05/27/2024 09:31:19 - INFO - __main__ -   Instantaneous batch size per device = 8
05/27/2024 09:31:19 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 8
05/27/2024 09:31:19 - INFO - __main__ -   Gradient Accumulation steps = 1
05/27/2024 09:31:19 - INFO - __main__ -   Total optimization steps = 7000000
05/27/2024 09:31:20 - INFO - __main__ -   Image path = ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/generated_images
05/27/2024 09:31:20 - INFO - accelerate.accelerator - Loading states from ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-10
Resuming from checkpoint checkpoint-10
05/27/2024 09:31:21 - INFO - accelerate.checkpointing - All model weights loaded successfully
05/27/2024 09:31:22 - INFO - accelerate.checkpointing - All optimizer states loaded successfully
05/27/2024 09:31:22 - INFO - accelerate.checkpointing - All scheduler states loaded successfully
05/27/2024 09:31:23 - INFO - accelerate.checkpointing - All dataloader sampler states loaded successfully
05/27/2024 09:31:23 - INFO - accelerate.checkpointing - All random states loaded successfully
05/27/2024 09:31:23 - INFO - accelerate.accelerator - Loading in 0 custom states
Epoch 0:   0%|          | 10/3500 [00:00<03:08, 18.51it/s]/home/srk1995/anaconda3/envs/ADM/lib/python3.8/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3483.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]


Epoch 0:   1%|          | 20/3500 [00:09<39:13,  1.48it/s, loss=0.365, lr=1.9e-6, step=19]05/27/2024 09:31:33 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:31:36 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20/optimizer.bin
05/27/2024 09:31:37 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20/scheduler.bin
05/27/2024 09:31:37 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20/sampler.bin
05/27/2024 09:31:38 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20/random_states_0.pkl
05/27/2024 09:31:38 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-20



Epoch 0:   1%|          | 30/3500 [00:21<46:35,  1.24it/s, loss=0.557, lr=2.9e-6, step=29]05/27/2024 09:31:45 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:31:48 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30/optimizer.bin
05/27/2024 09:31:49 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30/scheduler.bin
05/27/2024 09:31:49 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30/sampler.bin
05/27/2024 09:31:50 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30/random_states_0.pkl
05/27/2024 09:31:50 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-30



Epoch 0:   1%|          | 40/3500 [00:33<44:25,  1.30it/s, loss=0.436, lr=3.9e-6, step=39]05/27/2024 09:31:57 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:32:00 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40/optimizer.bin
05/27/2024 09:32:01 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40/scheduler.bin
05/27/2024 09:32:01 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40/sampler.bin
05/27/2024 09:32:01 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40/random_states_0.pkl
05/27/2024 09:32:01 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-40



Epoch 0:   1%|▏         | 50/3500 [00:44<43:49,  1.31it/s, loss=0.505, lr=4.9e-6, step=49]05/27/2024 09:32:09 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:32:12 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50/optimizer.bin
05/27/2024 09:32:12 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50/scheduler.bin
05/27/2024 09:32:12 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50/sampler.bin
05/27/2024 09:32:13 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50/random_states_0.pkl
05/27/2024 09:32:13 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-50



Epoch 0:   2%|▏         | 60/3500 [00:56<45:54,  1.25it/s, loss=0.333, lr=5.9e-6, step=59]05/27/2024 09:32:21 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:32:24 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60/optimizer.bin
05/27/2024 09:32:24 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60/scheduler.bin
05/27/2024 09:32:24 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60/sampler.bin
05/27/2024 09:32:25 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60/random_states_0.pkl
05/27/2024 09:32:25 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-60


Epoch 0:   2%|▏         | 70/3500 [01:08<43:42,  1.31it/s, loss=0.338, lr=6.9e-6, step=69]05/27/2024 09:32:32 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:32:35 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70/optimizer.bin
05/27/2024 09:32:36 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70/scheduler.bin
05/27/2024 09:32:36 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70/sampler.bin
05/27/2024 09:32:36 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70/random_states_0.pkl
05/27/2024 09:32:37 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-70



Epoch 0:   2%|▏         | 80/3500 [01:20<43:47,  1.30it/s, loss=0.276, lr=7.9e-6, step=79]05/27/2024 09:32:44 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:32:47 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80/optimizer.bin
05/27/2024 09:32:48 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80/scheduler.bin
05/27/2024 09:32:48 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80/sampler.bin
05/27/2024 09:32:48 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80/random_states_0.pkl
05/27/2024 09:32:48 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-80



Epoch 0:   3%|▎         | 90/3500 [01:31<42:13,  1.35it/s, loss=0.309, lr=8.9e-6, step=89]05/27/2024 09:32:55 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:32:59 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90/optimizer.bin
05/27/2024 09:32:59 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90/scheduler.bin
05/27/2024 09:33:00 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90/sampler.bin
05/27/2024 09:33:00 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90/random_states_0.pkl
05/27/2024 09:33:00 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-90



Epoch 0:   3%|▎         | 100/3500 [01:43<44:18,  1.28it/s, loss=0.309, lr=9.9e-6, step=99]05/27/2024 09:33:07 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:33:11 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100/optimizer.bin
05/27/2024 09:33:11 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100/scheduler.bin
05/27/2024 09:33:12 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100/sampler.bin
05/27/2024 09:33:12 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100/random_states_0.pkl
05/27/2024 09:33:12 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-100



Epoch 0:   3%|▎         | 110/3500 [01:55<42:38,  1.32it/s, loss=0.258, lr=1.09e-5, step=109]05/27/2024 09:33:20 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:33:23 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110/optimizer.bin
05/27/2024 09:33:24 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110/scheduler.bin
05/27/2024 09:33:24 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110/sampler.bin
05/27/2024 09:33:24 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110/random_states_0.pkl
05/27/2024 09:33:24 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-110



Epoch 0:   3%|▎         | 120/3500 [02:08<46:32,  1.21it/s, loss=0.204, lr=1.19e-5, step=119]05/27/2024 09:33:32 - INFO - accelerate.accelerator - Saving current state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120
Configuration saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120/unet/config.json
Model weights saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120/unet/diffusion_pytorch_model.safetensors
05/27/2024 09:33:35 - INFO - accelerate.checkpointing - Optimizer state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120/optimizer.bin
05/27/2024 09:33:36 - INFO - accelerate.checkpointing - Scheduler state saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120/scheduler.bin
05/27/2024 09:33:36 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120/sampler.bin
05/27/2024 09:33:37 - INFO - accelerate.checkpointing - Random states saved in ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120/random_states_0.pkl
05/27/2024 09:33:37 - INFO - __main__ - Saved state to ddpm-model-mattymchen/celeba-hq-64/Local-celeba-hq-2000-1000-0-b_bar/checkpoint-120
Epoch 0:   4%|▎         | 123/3500 [02:15<1:20:39,  1.43s/it, loss=0.217, lr=1.23e-5, step=123]
Epoch 0:   4%|▎         | 126/3500 [02:17<54:00,  1.04it/s, loss=0.213, lr=1.25e-5, step=125]
Epoch 0:   4%|▎         | 129/3500 [02:19<44:24,  1.26it/s, loss=0.271, lr=1.28e-5, step=128]
